sw.js:278 Service Worker loaded successfully
sw.js:11 Service Worker installing...
(index):1 SW registered:  ServiceWorkerRegistration
sw.js:15 Opened cache
 No user authenticated for version check
 No user authenticated for version update
 No user authenticated for version update
sw.js:30 Service Worker cache completed
sw.js:42 Service Worker activating...
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/logo192.png
 🔍 getUserNamesByIds called with: Array(3)
 🔢 Loading quantities for case: TMC-Singapore-2025-022 ID: becec500-2c0e-4bfe-b23a-56c50a796b30
 🔍 getUserNamesByIds called with: Array(3)
 📧 Looking up emails: Array(2)
 🔢 Loading quantities for case: TMC-Singapore-2025-TEST ID: 13d1dd82-5cd4-4c3f-b627-0a760b4bfeb7
 📧 Email lookup result: Array(1) Error: null
 📧 Mapped anrong.low@transmedicgroup.com -> An Rong Low
 🔢 Quantities query result: Object
 🔢 Mapped quantity: ACEF 1 Set A -> 1
 🔢 Mapped quantity: ACEF 1 Set C -> 1
 🔢 Mapped quantity: ACEF 1 Set B -> 1
 🔢 Mapped quantity: ACEF 1 Set D -> 1
 🔢 Final quantities state: Object
 🔢 Quantities query result: Object
 🔢 No quantities found for case
 ✅ Final getUserNamesByIds result: Object
 ✅ Final getUserNamesByIds result: Object
 Cross-Origin-Opener-Policy policy would block the window.closed call.
(anonymous) @ main.f6ddfd5b.js:2
 Cross-Origin-Opener-Policy policy would block the window.closed call.
(anonymous) @ main.f6ddfd5b.js:2
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/logo192.png
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/logo192.png
 Cross-Origin-Opener-Policy policy would block the window.close call.
o @ main.f6ddfd5b.js:2
 Cross-Origin-Opener-Policy policy would block the window.close call.
o @ main.f6ddfd5b.js:2
 🔍 getUserNamesByIds called with: Array(3)
 🔢 Loading quantities for case: TMC-Singapore-2025-022 ID: becec500-2c0e-4bfe-b23a-56c50a796b30
 🔍 getUserNamesByIds called with: Array(3)
 📧 Looking up emails: Array(2)
 🔢 Loading quantities for case: TMC-Singapore-2025-TEST ID: 13d1dd82-5cd4-4c3f-b627-0a760b4bfeb7
 🔢 Quantities query result: Object
 🔢 Mapped quantity: ACEF 1 Set A -> 1
 🔢 Mapped quantity: ACEF 1 Set C -> 1
 🔢 Mapped quantity: ACEF 1 Set B -> 1
 🔢 Mapped quantity: ACEF 1 Set D -> 1
 🔢 Final quantities state: Object
 📧 Email lookup result: Array(1) Error: null
 📧 Mapped anrong.low@transmedicgroup.com -> An Rong Low
 🔢 Quantities query result: Object
 🔢 No quantities found for case
 ✅ Final getUserNamesByIds result: Object
 ✅ Final getUserNamesByIds result: Object
 🔍 getUserNamesByIds called with: Array(3)
 🔢 Loading quantities for case: TMC-Singapore-2025-022 ID: becec500-2c0e-4bfe-b23a-56c50a796b30
 🔍 getUserNamesByIds called with: Array(3)
 📧 Looking up emails: Array(2)
 🔢 Loading quantities for case: TMC-Singapore-2025-TEST ID: 13d1dd82-5cd4-4c3f-b627-0a760b4bfeb7
 🔢 Quantities query result: Object
 🔢 No quantities found for case
 🔢 Quantities query result: Object
 🔢 Mapped quantity: ACEF 1 Set A -> 1
 🔢 Mapped quantity: ACEF 1 Set C -> 1
 🔢 Mapped quantity: ACEF 1 Set B -> 1
 🔢 Mapped quantity: ACEF 1 Set D -> 1
 🔢 Final quantities state: Object
 ✅ Final getUserNamesByIds result: Object
 📧 Email lookup result: Array(1) Error: null
 📧 Mapped anrong.low@transmedicgroup.com -> An Rong Low
 ✅ Final getUserNamesByIds result: Object
aqzjzjygflmxkcbfnjbe.supabase.co/rest/v1/rpc/recalculate_daily_usage:1  Failed to load resource: the server responded with a status of 404 ()
 🔍 getUserNamesByIds called with: Array(3)
 📧 Looking up emails: Array(2)
 📧 Email lookup result: Array(1) Error: null
 📧 Mapped anrong.low@transmedicgroup.com -> An Rong Low
 ✅ Final getUserNamesByIds result: Object
aqzjzjygflmxkcbfnjbe.supabase.co/rest/v1/rpc/recalculate_daily_usage:1  Failed to load resource: the server responded with a status of 404 ()
 Saving case with data: Object
 Insert result: Object
 No data returned from database insert
(anonymous) @ main.f6ddfd5b.js:2
 Case save error: Error: Failed to create case - no data returned from database
    at main.f6ddfd5b.js:2:491894
    at async xe.saveCase (main.f6ddfd5b.js:2:490691)
    at async main.f6ddfd5b.js:2:542955
    at async onSubmit (main.f6ddfd5b.js:2:735196)
(anonymous) @ main.f6ddfd5b.js:2
 Attempting to verify if case was saved despite error...
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/static/css/main.9cae78e7.css
sw.js:76 Serving from cache: https://tm-case-booking.vercel.app/manifest.json
 🔍 getUserNamesByIds called with: ['45d44b94-9979-4788-9df1-1c903eae77e4']
 🔢 Loading quantities for case: TMC-Singapore-2025-024 ID: 8cd9d57f-5980-4654-997d-549154ae3a0f
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low'}
 🔢 Quantities query result: {data: Array(0), error: null}
 🔢 No quantities found for case
 🔍 getUserNamesByIds called with: (2) ['45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user']
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low', current_user: 'Current User'}
 📬 processEmailNotifications called: {caseRef: 'TMC-Singapore-2025-024', newStatus: 'Order Prepared', oldStatus: 'Order Preparation', changedBy: '45d44b94-9979-4788-9df1-1c903eae77e4', submittedBy: '45d44b94-9979-4788-9df1-1c903eae77e4'}
 🔍 getUserNamesByIds called with: (3) ['45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', '45d44b94-9979-4788-9df1-1c903eae77e4']
 📬 Using access token for microsoft: Token found
 📬 Adding case submitter to recipients: 45d44b94-9979-4788-9df1-1c903eae77e4
 Found 3 recipients for Order Prepared notification: (3) ['jade.long@transmedicgroup.com', 'serene.lim@transmedicgroup.com', '45d44b94-9979-4788-9df1-1c903eae77e4']
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low', current_user: 'Current User'}
  POST https://graph.microsoft.com/v1.0/me/sendMail 400 (Bad Request)
sendOutlookEmail @ main.f6ddfd5b.js:2
sendEmail @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
await in (anonymous)
ye @ main.f6ddfd5b.js:2
await in ye
updateCaseStatus @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
ft @ main.f6ddfd5b.js:2
onClick @ main.f6ddfd5b.js:2
Re @ main.f6ddfd5b.js:2
qe @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
Ls @ main.f6ddfd5b.js:2
Fs @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
cc @ main.f6ddfd5b.js:2
Te @ main.f6ddfd5b.js:2
Ws @ main.f6ddfd5b.js:2
Kt @ main.f6ddfd5b.js:2
Yt @ main.f6ddfd5b.js:2
 Failed to send email notification for case TMC-Singapore-2025-024
(anonymous) @ main.f6ddfd5b.js:2
await in (anonymous)
ye @ main.f6ddfd5b.js:2
await in ye
updateCaseStatus @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
ft @ main.f6ddfd5b.js:2
onClick @ main.f6ddfd5b.js:2
Re @ main.f6ddfd5b.js:2
qe @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
Ls @ main.f6ddfd5b.js:2
Fs @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
cc @ main.f6ddfd5b.js:2
Te @ main.f6ddfd5b.js:2
Ws @ main.f6ddfd5b.js:2
Kt @ main.f6ddfd5b.js:2
Yt @ main.f6ddfd5b.js:2
  PATCH https://aqzjzjygflmxkcbfnjbe.supabase.co/rest/v1/case_bookings?id=eq.8cd9d57f-5980-4654-997d-549154ae3a0f 400 (Bad Request)
(anonymous) @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
i @ main.f6ddfd5b.js:2
Promise.then
l @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
_e @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
then @ main.f6ddfd5b.js:2
  PATCH https://aqzjzjygflmxkcbfnjbe.supabase.co/rest/v1/case_bookings?id=eq.8cd9d57f-5980-4654-997d-549154ae3a0f 400 (Bad Request)
(anonymous) @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
i @ main.f6ddfd5b.js:2
Promise.then
l @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
_e @ main.f6ddfd5b.js:2
(anonymous) @ main.f6ddfd5b.js:2
then @ main.f6ddfd5b.js:2
 🔍 getUserNamesByIds called with: (5) ['45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', '45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', 'current_user']
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low', current_user: 'Current User'}
 🔍 getUserNamesByIds called with: (5) ['45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', '45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', 'current_user']
 🔢 Loading quantities for case: TMC-Singapore-2025-024 ID: 8cd9d57f-5980-4654-997d-549154ae3a0f
 🔢 Quantities query result: {data: Array(0), error: null}
 🔢 No quantities found for case
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low', current_user: 'Current User'}
 🔍 getUserNamesByIds called with: (5) ['45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', '45d44b94-9979-4788-9df1-1c903eae77e4', 'current_user', 'current_user']
 🔢 Loading quantities for case: TMC-Singapore-2025-024 ID: 8cd9d57f-5980-4654-997d-549154ae3a0f
 🔢 Quantities query result: {data: Array(0), error: null}
 🔢 No quantities found for case
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low', current_user: 'Current User'}
 🔍 getUserNamesByIds called with: ['45d44b94-9979-4788-9df1-1c903eae77e4']
 ✅ Final getUserNamesByIds result: {45d44b94-9979-4788-9df1-1c903eae77e4: 'An Rong Low'}
